





INSERT INTO store_ID1 (Date, New_rentals, Active_rentals, Rented_titles, No_of_customers_with_rentals, Rentals_>_10_days)
  VALUES (value1, value2, value3, value4, value5);





SELECT rental_date as Date, /*pobieramy datę*/
  SUM(DISTINCT(rental_id)) AS New_rentals, /*sumująć indywidualne zamówienia otrzymujemy ilość nowych zamówień danego dnia*/  
  (SELECT SUM(DISTINCT(rental_id)) FROM rental WHERE rental_id BETWEEN rental_date and return_date) as Active_rentals /*stosując zagnieżdżone query zbieram informację*/
  /*tylko o aktywnych wypożyczeniach*/
  (SELECT SUM(DISTINCT(rental_id)) FROM rental WHERE rental_id BETWEEN rental_date and return_date) + SUM(DISTINCT(rental_id)) AS Rented_titles, /*Tutaj wystarczy suma dwóch poprzednich kolumn*/
  SUM(DISTINCT(customer_id)) AS No_of_customers_with_rentals /*sumując indywidualncyh klientów z danego dnia mamy informację o ich ilości*/
  (SELECT SUM(DISTINCT(rental_id)) FROM rental WHERE rental_date + INTERVAL CURRENT_DATE() DAY > 10 as Rentals_>_10_days /*suma zamówień przekraczających 10 dni*/
FROM rental
GROUP BY rental_date /*grupujemy wszystko dla każdego dnia*/
WHERE stor_store_id = 1 /*jeśli dobrze zrozumiałem zadanie to raport ma być dla sklepu nr 1*/
