





INSERT INTO store_ID1 (Date, New_rentals, Active_rentals, Rented_titles, No_of_customers_with_rentals, Rentals_>_10_days)
  VALUES (value1, value2, value3, value4, value5);





SELECT FORMAT(rental.rental_date, 'd') as Date, /*pobieramy datę i ją formatuje do pożądanej wartości*/
	COUNT(DISTINCT(rental.rental_id)) AS New_rentals, /*sumująć indywidualne zamówienia otrzymujemy ilość nowych zamówień danego dnia*/  
	(SELECT COUNT(DISTINCT(rental.rental_id)) 
		FROM rental 
		WHERE return_date > CURRENT_TIMESTAMP and return_date IS NULL) as Active_rentals, /*stosując zagnieżdżone query zbieram informację*/
	COUNT(DISTINCT(rental.customer_id)) AS No_of_customers_with_rentals, /*sumując indywidualncyh klientów z danego dnia mamy informację o ich ilości*/
	(SELECT COUNT(DISTINCT(rental.rental_id)) 
			FROM rental as rental INNER JOIN inventory as inventory ON rental.inventory_id = inventory.inventory_id INNER JOIN film as film ON inventory.film_id = film.film_id 
			WHERE rental.rental_date + film.rental_duration < 10) as Rentals_over_10_days /*suma zamówień przekraczających 10 dni*/
FROM rental as rental INNER JOIN inventory as inventory ON rental.inventory_id = inventory.inventory_id
WHERE inventory.store_id = 1/*jeśli dobrze zrozumiałem zadanie to raport ma być dla sklepu nr 1 i od konkretnej daty*/
GROUP BY FORMAT(rental.rental_date, 'd')
ORDER BY FORMAT(rental.rental_date, 'd') DESC; /*grupujemy wszystko dla każdego dnia*/
